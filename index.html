<!DOCTYPE html>
<html>
	<head>
		<title>CELDA</title>
		<script>
	
	function CreateMatrix(rows) {
	//crea la matriz para almacenar cada celda
  		var matrix = [];
        for (var i=0;i<rows;i++) {
     		matrix[i] = [];
  	}
	  return matrix;
}
	
	
	
	function cuadrado(pos_x,pos_y,dimension_t) {
		posx = pos_x,
		posy = pos_y,
		dimension = dimension_t,
		color ='#000000',
		this.getPos_y = function(){
			return this.posy;
		};
		this.getPos_x = function(){
			return this.posx;
		};
		this.getDimension = function(){
			return this.dimension;
		};
	}
	
	var Nivel = {
		
		posicionY: 1,
		
		init: function() {
			this.width = document.getElementById('width').value;
			this.height = document.getElementById('height').value;
			this.draw();
				//cargarListaMapasPrivada();
		},
		getHeight: function() {
			return this.height;
		},
		getWidth: function(){
			return this.width;
		},
		//PRIVATE
		generarMapaMatriz: function(){
		
		console.log(this.getWidth());
		console.log(this.getHeight());
		
		matrix = CreateMatrix(this.getWidth()*this.getHeight());

		console.log(matrix);
		
		for (i=0; i<this.getHeight(); i++){
			for (j=0; j<this.getWidth(); j++){
			//crea el cuadrado con los datos correspondientes, position,color;...
					cuadra = new cuadrado(i*25,j*25,25);
					//agrega a matrix
					matrix[i*25][j*25] = cuadra;
					contexto.strokeRect(j*25,i*25,25,25);
				}
			}
			//print 
			for (i=0; i<this.getHeight(); i++){
					for (j=0; j<this.getWidth(); j++){
					
						console.log(matrix[i][j]);
				}
			}
		  },
		draw: function() {
		
		var elemento = document.getElementById('myCanvas');
		
		//Comprobación sobre si encontramos un elemento
		//y podemos extraer su contexto con getContext(), que indica compatibilidad con canvas
		if (elemento && elemento.getContext) {
			
		   //Accedo al contexto de '2d' de este canvas, necesario para dibujar
		   contexto = elemento.getContext('2d');
		   if (contexto) {
			 //Si tengo el contexto 2d es que todo ha ido bien y puedo empezar a dibujar 
			  contexto.strokeStyle = '#000000';
			  this.generarMapaMatriz();
			  contexto.fillStyle = "#BFF000";
				
				//ESTO POSICIONA EL RECUADO ROJO SEGÚN DONDE SE DESEA Q SEA EL PUNTO DE INICIO
				//SI O SI DEBE ESTAR SOBRE EL MARGEN IZQUIERDO
				cuadrado = new cuadrado(1,13,25);
				cuadrado.posx=1;
				cuadrado.posy=13;
				cuadrado.dimension=25;
				//no anda el constructor
				console.log(cuadrado.getPos_x());
				cuadrado.posy = (( cuadrado.getPos_x() - 1) * 50 ) + cuadrado.getPos_y();
				contexto.fillRect(cuadrado.getPos_x(),cuadrado.getPos_y(), cuadrado.getDimension(), cuadrado.getDimension());
		   }
		}
	},
	selectSquare: function(){
		var elemento = document.getElementById('myCanvas');
		elemento.onClick = alert('selecciono!');
	}	
		
		
	}
	</script> 	
	</head>
	<body onload="Nivel.init();">
		<canvas id="myCanvas" width="500" height="350" onclick="Nivel.selectSquare();">
			Este texto se muestra para los navegadores no compatibles con canvas.
			<br>
			Por favor, utiliza Firefox, Chrome, Safari u Opera.
		</canvas>
		<br>
		<input type="button" value="Avanzar" onClick="miCanvas.avanzar()">
		<br>
		<select id="mapas">
		</select>
		<br>	
		<button type="button" onclick="miCanvas.cargarRecorrido()">cargar recorrido</button>
		<br>
		<form>
			Anchura: <input id="width" type="text" value="320" name="width"><br>
			Altura: <input id="height" type="text" value= "240" name="height"><br>
			<input type="button" value="Submit" onClick="Nivel.newSize()">
		</form>
		
		
	</body>
</html>
